# Smart Mirror

## 🚀 About Us
해당 프로젝트는 대학 졸업작품으로, IoT와 AI를 결합한 일상에 의미있는 작품을 목표로 개발된 프로젝트입니다.

일상 생활에서 빠질 수 없는 `거울`과 `AI`를 결합하여, 현재 내 상태의 피부를 진단하는 `스마트 미러`를 만들어보자는 취지에서 시작되었습니다.

- 인원 : 4명
- 역할
    - [Python] 데이터 전처리
    - [TypeScript, Next.js] 프론트엔드 개발 (100% 관여)
    - [GCP] 인프라 운영 (100% 관여)

## Projects
- smart_mirror_fe - 프론트엔드
    - 입력장치는 `카메라`만을 사용하는 Web 서비스입니다
- smart_mirror_be - 백엔드
    - 모델 학습과 API 서버로 활용되었습니다
- data_view - QR 코드로 데이터를 사용자 휴대폰으로 받아볼 수 있는 사이트
    - 해당 코드는 오로지 URL 리소스를 받아 출력하는 목적으로 개발되었습니다
    - 이는 더 좋은 서비스로 만들기 위해 추가된 기능으로, AI로 제작하였습니다.

## ISSUE
### 마우스, 키보드가 없어야하는 웹 환경

#### 어째서?
- 스마트 미러의 기반은 웹 또는 앱이여야 했습니다. 다만, 전공을 살리고 싶은 팀원들의 의견에 따라 웹으로 결정하였지만 `환경`에 문제가 있었습니다.
- `거울`이라는 특성은 주변 장치(마우스, 키보드)가 존재하면 안되는 구조이기에 이 부분을 살릴 필요가 있습니다
#### 해결책
- 웹 개발의 기초는 다르지만, 카메라 하나만으로 해결하기 위해 `마우스`를 통한 동작 이벤트가 아닌 `카메라`를 통한 동작 이벤트로 개발하였습니다.
- 개발 중에는 `프론트`에 적합한 `모션 제스처` 모델도 필요하여, 500개 분량의 제스처 데이터를 학습하여 이를 개발하였습니다.

### 예상보다 더 낮은 하드웨어 성능
- 실제 초기 개발 당시에는 손 동작을 캡쳐하여 딥러닝을 진행하였고, 이는 단순한 제스처 모션 인식도 할 수 있었던 프로젝트입니다.
- 프론트엔드는 최초 디자인 및 배포 준비까지 완료하며 스마트 미러 제품 제작 및 설치를 대기하고 있었습니다.
- 하지만 `라즈베리파이`의 성능은 예상했던 것보다 더 낮은 사양이였고, 제스처 인식이 전혀 동작하지 않았습니다.
- 우리는 이를 처리하기엔 경량화가 필요했습니다

#### 문제
- 많은 시간이 투여되었지만, 당시 성능 개선과 최적화 부분의 능력이 부족했습니다.
- 웹으로 선택한 것이 잘못되었는지, Next.js를 선택한 것이 잘못되었는지
- 제품 수령 후 발표까지 1달 남짓한 기간에 다양한 방식으로 시도했지만, 라즈베리파이가 실시간에 대해 전혀 대응하지 못했습니다.
- 그래서 일부 돌아가기로 했습니다

#### 해결
- 피부 상태를 확인하기 위해 `카메라 얼굴 인식` 모델은 필수였습니다.
- 하지만, 제스처나 다른 부분은 사용자 편의를 위한 부분이였기에 과감히 제거했습니다.
- 대신 일정 시간 대기하는 개념으로 변경하였으며, 시간이 지나면 화면이 넘어가도록 구성했습니다.

### 얼굴 오인식으로 실패
- 여기서 문제가 종료되면 좋았지만, 백엔드 로직 중 `얼굴 인식` 로직에 치명적인 문제가 있었습니다. 개인 노트북에서는 정상 동작하지만, 이상하게도 실제 거울에서는 얼굴로 인식하지 못해 오류가 발생했습니다.

#### 프론트 문제?
- 프론트에서 API로 얼굴 데이터를 이상하게 보내주는 지 살펴보았지만, 이는 Json 데이터에서 원본 사진 데이터로 전송하는 기반을 바꿨으며, 정상적으로 검증을 위한 사진 데이터 5장을 보내고 있었습니다.

#### 백엔드 문제
- 인프라 로그를 살펴보았을 때 `얼굴 검증` 기능에서 상당히 낮은 일치율을 보이고 있었습니다. 결국 해당 기능은 실제 발표 당시에 문제가 되어 `서버 오류` 로그를 출력하며, 당시 1차 검증에서 탈락을 하게 되었습니다

#### 해결
- 이는 백엔드 로직에서 검증하기엔 불완전한 요소가 많아 프론트에서 처리하도록 구조를 변경했습니다.
- 얼굴 모델은 어차피 불안정한 환경에서는 피부를 정확히 판단하기 어렵습니다. 따라서 `피부 색상` 및 `얼굴 위치`를 캡쳐하여 5초 이상 유지하면 전송되도록 변경했습니다.
- 당시 손바닥으로 카메라를 가려도 동작되는 치명적인 문제가 있었지만, 서비스의 기동조차 되지 않는 것은 더욱 심각한 문제였기에 최소한의 안전 장치로 만들었습니다.


## Review
프로젝트 자체의 성적은 대학 내 `3위`로 비교적 우수한 결과지만, 최종 코드 결과물만 놓고본다면 최악이라고 생각합니다. 개발 과정에서는 팀원과 대학에서 밤낮 가릴 거 없이 새벽까지 작업하면서 많은 시간이 투여되었지만 일부 코드들은 실제로 사용할 수 없어 폐기 또는 무산되었고, 코드 문화, 코딩 컨벤션, 테스트 등 그런 부분은 전혀 생각하지 않아 포트폴리오로 작성하기엔 많이 아쉬웠던 것 같습니다.

리뷰를 작성하는 지금 돌아보고 생각해보면, 왜 commit도 작은 단위로 진행하지 않았고 어쩌면 전공자 1학년이 봐도 어이없을 수준의 코드일 수 있다 생각합니다. 아마 3학년임에도 Github를 잘 쓰지 않았던 점이 원인이지 않을까 싶습니다.

그렇지만 해당 프로젝트에서는 모두가 낮은 수준의 프로그래밍 능력을 가졌음에도 불구하고 끝까지 협업하며, 이탈자 없이 완수하며 `3위`를 수상했다는 점을 저만의 포트폴리오로 남기고 싶었습니다.

4명의 팀원 중 2명은 이번이 마지막 개발로 전공자로서의 개발자의 길을 포기하였지만, 프로젝트를 포기하지 않고 끝까지 함께 나아가준 팀원들에게 감사합니다.
